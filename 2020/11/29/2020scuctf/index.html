<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="无名小站">
    <meta name="author" content="Akk0">
    
    <title>
        
            2020SCUctf |
        
        Akk0&#39;s Blog
    </title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="shortcut icon" href="/images/avatar.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":false},"style":{"primary_color":"#CC99FF","avatar":"/images/avatar.jpg","favicon":"/images/avatar.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"background_img":"/images/30.jpg","description":"Welcome to Akk0's Blog."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.0"};
    KEEP.language_ago = undefined;
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Akk0's Blog" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                Akk0&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                友链
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">友链</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">2020SCUctf</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Akk0</span>
                        
                            <span class="author-label">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2020-11-29 10:11:00
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Web/">Web</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Crypto/">Crypto</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Reverse/">Reverse</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>10 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="加v看蟹黄堡秘方-19级-writeup"><a href="#加v看蟹黄堡秘方-19级-writeup" class="headerlink" title="加v看蟹黄堡秘方-19级 writeup"></a>加v看蟹黄堡秘方-19级 writeup</h1><p>written by</p>
<p><em>mahor0</em></p>
<p><em>Raylin</em></p>
<hr>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><hr>
<h3 id="EasyF5"><a href="#EasyF5" class="headerlink" title="EasyF5:"></a>EasyF5:</h3><p>一键F5<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easyf5.png/"><br>得到flag</p>
<hr>
<h3 id="easypack"><a href="#easypack" class="headerlink" title="easypack"></a>easypack</h3><p>使用upx脱壳</p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack1.png"></p>
<p>使用OD打开<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack2.png"><br>使用插件中文搜索中的智能搜索<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack3.png"><br>双击跳转<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack4.png"><br>打断点<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack5.png"><br>F9运行，随意输入<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack6.png"><br>发现flag<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easypack7.png"></p>
<hr>
<h3 id="pytrade"><a href="#pytrade" class="headerlink" title="pytrade"></a>pytrade</h3><p>反编译结果如下<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/pytrade1.png"><br>Base64解码得到flag<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/pytrade2.png"></p>
<hr>
<h3 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h3><p>OD运行，通过中文搜索引擎智能搜索，双击选中error进入</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.1.png"></p>
<p>选中输入验证码跳转处</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.2.png"></p>
<p>找到跳转开始处</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.3.png"></p>
<p>nop</p>
<p><img src="https://gitee.com/see1c3y/scuctf2020/raw/master/re/re4/re4.5.png"></p>
<p>选中刚才用NOP填充的代码段，右键单击“复制到可执行文件”，“选择”，在新弹出的界面上点击右键–单击“保存文件”,然后选择保存路径和文件名</p>
<p>打开刚保存的文件，得到flag</p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/crackme.png"></p>
<hr>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>使用ida,F5<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/maze1.png"><br>查看伪代码码知道DUR分别表示下上右三个方向，查看maze<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/maze2.png"><br>分析知为15* 10，写python脚本得到迷宫</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">maze = <span class="string">&#x27; *   *****   * *********  *********    *********&#x27;</span></span><br><span class="line">maze_len = <span class="built_in">len</span>(maze)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,maze_len-<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="built_in">print</span>(maze[i:i + <span class="number">10</span>])</span><br></pre></td></tr></table></figure>
<p>通过DUR三个控制方向即可获得flag</p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/maze3.png"></p>
<hr>
<h3 id="decryptme"><a href="#decryptme" class="headerlink" title="decryptme"></a>decryptme</h3><p>ida一键F5<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/decrptme1.png"><br>写python脚本爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">encode_str=<span class="string">&#x27;34e8h9?&lt;&lt;mkCD&gt;F@DEDCzHxxKRQRNSRS&#x27;</span></span><br><span class="line">len_of_str = <span class="built_in">len</span>(encode_str)</span><br><span class="line"><span class="built_in">str</span>=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len_of_str):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>,<span class="number">123</span>):</span><br><span class="line">        v7 = j</span><br><span class="line">        v6 = i</span><br><span class="line">        v4 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            v4 = <span class="number">2</span> * (v6 &amp; v7)</span><br><span class="line">            v7 ^= v6</span><br><span class="line">            v6 = v4</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> v4:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(v7) == encode_str[i]:</span><br><span class="line">            <span class="built_in">str</span> += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>得到结果</p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/decrptme2.png"></p>
<p>代入验证<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/decrptme3.png"></p>
<hr>
<h3 id="pytrade-plus"><a href="#pytrade-plus" class="headerlink" title="pytrade-plus"></a>pytrade-plus</h3><p>反编译<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/pytrade-plus1.png"><br>了解MVC知道controller就是要找的文件<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/pytrade-plus2.png"><br>使用在线反编译<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/pytrade-plus3.png"><br>得到代码，开始解方程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line">magicnum = <span class="number">6022643662067204678412214834917825274663312630925087389260279631835650751300240970025848237913353272826623631607</span></span><br><span class="line">x = sp.Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">f = x ** <span class="number">7</span> - <span class="number">300</span> * x ** <span class="number">6</span> - x ** <span class="number">3</span> + x - <span class="number">6022643662067204678412214834917825274663312630925087389260279631835650751300240970025848237913353272826623631607</span></span><br><span class="line">x = sp.solve(f)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>
<p>得到x=<code>9301243714092307</code>，转换得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">b&quot;9301243714092307&quot;</span></span><br><span class="line">flag = binascii.b2a_hex(flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>得到flag=39333031323433373134303932333037，代入验证</p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/pytrade-plus4.png"></p>
<hr>
<h2 id="MiSC"><a href="#MiSC" class="headerlink" title="MiSC"></a>MiSC</h2><hr>
<h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>关注公众号</p>
<hr>
<h3 id="easy-encode"><a href="#easy-encode" class="headerlink" title="easy_encode"></a>easy_encode</h3><p>下载得到<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easy_encode1.png"><br>猜测为摩斯密码，在word文件里进行替换<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easy_encode2.png"><br>解密得到thankyoufororderingyeltsakcir‘<a class="link"   href="mailto:&#x73;&#x66;&#108;&#x61;&#103;&#100;&#x65;&#x6c;&#x69;&#118;&#x65;&#x72;&#121;&#x79;&#111;&#x75;&#114;&#x66;&#108;&#x61;&#103;&#105;&#115;&#115;&#x63;&#117;&#99;&#x74;&#102;&#x72;&#x33;&#x40;&#x64;&#x5f;&#98;&#x33;&#x74;&#x77;&#51;&#51;&#110;&#x5f;&#116;&#104;&#51;&#x5f;&#108;&#49;&#110;&#x33;&#115;&#x2e;&#x77;&#x65;&#x68;&#x6f;&#x70;&#101;&#x79;&#111;&#117;&#108;&#x69;&#107;&#x65;&#111;&#x75;&#114;&#115;&#x65;&#x72;&#x76;&#105;&#99;&#101;&#x61;&#110;&#100;&#116;&#114;&#121;&#97;&#103;&#x61;&#105;&#x6e;" >&#x73;&#x66;&#108;&#x61;&#103;&#100;&#x65;&#x6c;&#x69;&#118;&#x65;&#x72;&#121;&#x79;&#111;&#x75;&#114;&#x66;&#108;&#x61;&#103;&#105;&#115;&#115;&#x63;&#117;&#99;&#x74;&#102;&#x72;&#x33;&#x40;&#x64;&#x5f;&#98;&#x33;&#x74;&#x77;&#51;&#51;&#110;&#x5f;&#116;&#104;&#51;&#x5f;&#108;&#49;&#110;&#x33;&#115;&#x2e;&#x77;&#x65;&#x68;&#x6f;&#x70;&#101;&#x79;&#111;&#117;&#108;&#x69;&#107;&#x65;&#111;&#x75;&#114;&#115;&#x65;&#x72;&#x76;&#105;&#99;&#101;&#x61;&#110;&#100;&#116;&#114;&#121;&#97;&#103;&#x61;&#105;&#x6e;<i class="fas fa-external-link-alt"></i></a>.<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easy_encode3.png"></p>
<hr>
<h3 id="Excalibur"><a href="#Excalibur" class="headerlink" title="Excalibur"></a>Excalibur</h3><p>用jd-gui打开<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/excalibur1.png"><br>得到flag</p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/excalibur2.png"></p>
<hr>
<h3 id="ylbnb"><a href="#ylbnb" class="headerlink" title="ylbnb!"></a>ylbnb!</h3><p>训练了“人工”智能，证明如下(误<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/ylbnb1.jpg"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/ylbnb2.jpg"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/ylbnb3.jpg"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/ylbnb4.jpg"></p>
<hr>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><hr>
<h3 id="classic-1"><a href="#classic-1" class="headerlink" title="classic_1"></a>classic_1</h3><p>凯撒密码</p>
<hr>
<h3 id="classic-2"><a href="#classic-2" class="headerlink" title="classic_2"></a>classic_2</h3><p>hex-base64-莫斯<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/classic_2.png"><br>得到scuctf%u7b041918fc1ef6348768578f505f69d197%u7d</p>
<p>%u7b和%u7d替换成{}</p>
<hr>
<h3 id="RSA-1-与-RSA-3"><a href="#RSA-1-与-RSA-3" class="headerlink" title="RSA_1 与 RSA_3"></a>RSA_1 与 RSA_3</h3><p>rsa1与rsa3均可使用如下脚本进行低指数加密攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"><span class="comment"># 读入 n，密文</span></span><br><span class="line">n= <span class="number">17076697689025821279984148703479525857912324396375097877800474725170566885465833732966897433803722770843910606215420934526050277173030062927090405120718833473629930226217051580832179577629652910778242159108718885516149768995851175071714817922775555170553827627677999093195969471873530031984433631909841287167351534954860426002075822101506835880510505034002629168205724869128357383388034971402180363910826536064357845040799329301895842061729319929568340334416516796267886218679042058969927331452548377324349084816441144473807565907927986545026739667157223640848553663532280797054758912745891410981282851031085852562257</span></span><br><span class="line">c= <span class="number">892408374578063131162925795619920779766603018609992406621503024400320421262482556891045333045408815199768659578199823419716777827460090306221618906101139272423449131313434967763664295600593363990276765767066758967765012850672428517786210813209127040442832574380675662826137452780727264357</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;n=&#x27;</span>, n</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c=&#x27;</span>, c</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;[+]Detecting m...&#x27;</span></span><br><span class="line">result = gmpy2.iroot(c, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;  [-]The c has cubic root?&#x27;</span>, result[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">if</span> result[<span class="number">1</span>]: <span class="built_in">print</span> <span class="string">&#x27;  [-]The m is:&#x27;</span>, <span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>(result[<span class="number">0</span>]).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;[!]All Done!&#x27;</span></span><br></pre></td></tr></table></figure>
<p>结果如下<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/rsa_1.png"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/rsa_3.png"></p>
<hr>
<h3 id="math-1"><a href="#math-1" class="headerlink" title="math_1"></a>math_1</h3><p>中国剩余定理，脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">prime_list = []</span><br><span class="line">c_list = []</span><br><span class="line">inverse_list=[]</span><br><span class="line">m = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    m*=prime_list[i]</span><br><span class="line">M_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    M_list.append(m//prime_list[i])</span><br><span class="line">inverse_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    inv = inverse(M_list[i],prime_list[i])</span><br><span class="line">    inverse_list.append(inv)</span><br><span class="line">result =  <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    result+=inverse_list[i]*M_list[i]*c_list[i]</span><br><span class="line">result %= m</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">    f = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">if</span> result % prime_list[i] != c_list[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;false&quot;</span>)</span><br><span class="line">            f = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> f == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;flag is scuctf&#123; %d&#125;&quot;</span>%(result%<span class="number">1145141145141145141145141919810</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    result += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>得到 flag=<code>scuctf&#123;234970795255267031279059393553&#125;</code></p>
<hr>
<h3 id="RSA-2"><a href="#RSA-2" class="headerlink" title="RSA_2"></a>RSA_2</h3><p>使用工具可将n分解为多个素数,然后即可按原理求解<br>脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">21280377217500047527333756734822477656202976970565771310208586426341167199342722337358334403397116963913950346969157</span></span><br><span class="line">c = <span class="number">7162732898109470668490761172640544970587920562229245172318483665877098759808623298921271357899945260719802967519239</span></span><br><span class="line">r = <span class="number">199045230832669039221046041578658179479</span></span><br><span class="line">s = <span class="number">319438022064098846441615805897528174851</span></span><br><span class="line">t = <span class="number">334688613728124045578795340681788885633</span></span><br><span class="line">phi = (r-<span class="number">1</span>)*(s-<span class="number">1</span>)*(t-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(r*s*t)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d=inverse(e,phi)</span><br><span class="line">decode =<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag = long_to_bytes(decode)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>


<hr>
<h3 id="math-2"><a href="#math-2" class="headerlink" title="math_2"></a>math_2</h3><p>求解二次剩余，从网上找了一个求解二次剩余的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_power</span>(<span class="params">a, b, p</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    求快速幂。ret = a^b%p。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        a: 底数。大于等于0并且是整数。</span></span><br><span class="line"><span class="string">        b: 指数。大于等于0并且是整数。</span></span><br><span class="line"><span class="string">        p: 模数。大于0并且是整数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        返回结果。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Raises:</span></span><br><span class="line"><span class="string">        IOError: 无错误。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a = a % p</span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> b &amp; <span class="number">1</span>:</span><br><span class="line">            ans = (ans * a) % p</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span></span><br><span class="line">        a = (a * a) % p</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_have_sqrt_model</span>(<span class="params">x, p</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        是否有模平方根y*y=x mod p,已知x,p,判断是否存在y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            x: 大于0并且小于p的整数。</span></span><br><span class="line"><span class="string">            p: 质数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            返回结果,true表示有模平方根;false表示没有模平方根。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises:</span></span><br><span class="line"><span class="string">            IOError: 无错误。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ret = quick_power(x, (p - <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line">    <span class="keyword">if</span> ret == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sqrt_model</span>(<span class="params">x, p</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        求模平方根y*y=x mod p,已知x,p求y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            x: 大于0并且小于p的整数。</span></span><br><span class="line"><span class="string">            p: 质数。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            返回结果y。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Raises:</span></span><br><span class="line"><span class="string">            IOError: 无错误。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> is_have_sqrt_model(x, p):</span><br><span class="line">        t = <span class="number">0</span></span><br><span class="line">        <span class="comment"># p-1=(2^t)*s //s是奇数</span></span><br><span class="line">        s = p - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> s % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            s = s // <span class="number">2</span></span><br><span class="line">            t = t + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">            ret = quick_power(x, (s + <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line">            <span class="keyword">return</span> ret, p - ret</span><br><span class="line">        <span class="keyword">elif</span> t &gt;= <span class="number">2</span>:</span><br><span class="line">            x_ = quick_power(x, p - <span class="number">2</span>, p)</span><br><span class="line">            n = <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> is_have_sqrt_model(n, p):</span><br><span class="line">                n = n + <span class="number">1</span></span><br><span class="line">            b = quick_power(n, s, p)</span><br><span class="line">            ret = quick_power(x, (s + <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line">            t_ = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> t - <span class="number">1</span> &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> quick_power(x_ * ret * ret, <span class="number">2</span> ** (t - <span class="number">2</span>), p) == <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    ret = ret * (b ** (<span class="number">2</span> ** t_)) % p</span><br><span class="line">                t = t - <span class="number">1</span></span><br><span class="line">                t_ = t_ + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> ret, p - ret</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">2</span>, -<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(get_sqrt_model(<span class="number">11451419198101926081719260817111</span>, <span class="number">8497980875583539713991243773941802042180496489377326522174599746685528850719812035800799014030522052269804143947777659192760008656733593814889715667890907</span>))</span><br></pre></td></tr></table></figure>
<p>找到对应的解，代入j即可获得flag</p>
<hr>
<h3 id="baby-pad"><a href="#baby-pad" class="headerlink" title="baby_pad"></a>baby_pad</h3><p>观察pad与密文可知,密文后方加了5个‘0x05’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">M</span>):</span></span><br><span class="line">    pad_length = <span class="number">16</span>-<span class="built_in">len</span>(M)%<span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> M.decode()+<span class="built_in">chr</span>(pad_length)*pad_length</span><br><span class="line">cipher = <span class="string">&#x27;0b1b0d1b0c1e031d190b01270c0a111b13131313050505050505050505050505&#x27;</span></span><br></pre></td></tr></table></figure>

<p>按照异或运算，脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line">cipher = <span class="string">b&quot;\x0b\x1b\r\x1b\x0c\x1e\x03\x1d\x19\x0b\x01&#x27;\x0c\n\x11\x1b\x13\x13\x13\x13\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05&quot;</span>.decode()</span><br><span class="line"></span><br><span class="line">pad_decoded = cipher[:-<span class="number">5</span>].encode()</span><br><span class="line">key = <span class="string">b&#x27;x&#x27;</span>*<span class="built_in">len</span>(pad_decoded)</span><br><span class="line"><span class="built_in">print</span>(strxor(pad_decoded,key).decode())</span><br></pre></td></tr></table></figure>
<p>flag为 <code>scuctf&#123;easy_trickkkk&#125;&#125;&#125;&#125;&#125;&#125;&#125;</code></p>
<hr>
<h3 id="classic-3"><a href="#classic-3" class="headerlink" title="classic_3"></a>classic_3</h3><p>将题目问题转换为类似问题<br><a class="link"   target="_blank" rel="noopener" href="https://fitzbc.github.io/2019/08/04/De1CTF-xorz-Writeup/" >类似题<i class="fas fa-external-link-alt"></i></a><br>题目代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, plain <span class="comment">#plain is an English paragraph containing uppercase and lowercase letters, spaces and punctuation marks.</span></span><br><span class="line">key = flag.strip(<span class="string">&quot;scuctf&#123;&quot;</span>).strip(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">ki = cycle(key)</span><br><span class="line">cipher  = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(((<span class="built_in">ord</span>(<span class="built_in">next</span>(ki))^<span class="built_in">ord</span>(p))+<span class="number">1</span>)%<span class="number">256</span>) <span class="keyword">for</span> p <span class="keyword">in</span> plain])</span><br><span class="line"><span class="built_in">print</span>(cipher.encode().<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment">#output: 1f124d150f1f460159124952072041541d584438011e0e175f780d1944190d1755451d0e141504470108120d264a05020918254a4d0b1c4e131644551d5c074d561517120d264a0802171739094144071a4604520849480c0a15131555442d1017080b1f3f17050e0b1f1759111e1d14150e4854085a07640d0108071b780b0b440e090a1e561345140b19150513434438021649010339070544010c461e5f181b57081a591b0849506401054913142546190c0b4e17125208085e440453544059052c1e5d490d0778130e11501a0e1211080e5311045b541d5844080903040c1825174144071a4604520849480c0a150104440b2e0f51080453400b1d07444e0d0111040a4144195d1754470b2e1e161b461e324609071d1e051e43594945074d5d13181207360d0312121b3f0c0c440e09041c431249471141150517120c230e51070b07400d03055010011360070e1417201954055544350d030e46143c0a4d0501050c141111024207104154085f440c0d121f011d7c461c07501b010756550a60104d541d1b6005640e1a1b01122446190c0b4e0b0159121b14150e4e5f5f590e641b190818077c46190c0b4e1612431e0858441c560154430d6e4a170a18533c0d0807501a0e1211051b57110a5b085442073201200d4a53240e0e18501f0b1a565508564406410154600d2b1b1a0e170778051a180803181e451e0e4144065b011b4318270e51080c533f1220440e090d1b58551b57010a5e061756506410201b4616390b094401204613600749571606596054590e641e190e460223160a12040d121e47124958070c471717120d264a14080903371806110104461c5f19121e</span></span><br></pre></td></tr></table></figure>

<p>首先去1，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cipher = <span class="string">&#x27;1f124d150f1f460159124952072041541d584438011e0e175f780d1944190d1755451d0e141504470108120d264a05020918254a4d0b1c4e131644551d5c074d561517120d264a0802171739094144071a4604520849480c0a15131555442d1017080b1f3f17050e0b1f1759111e1d14150e4854085a07640d0108071b780b0b440e090a1e561345140b19150513434438021649010339070544010c461e5f181b57081a591b0849506401054913142546190c0b4e17125208085e440453544059052c1e5d490d0778130e11501a0e1211080e5311045b541d5844080903040c1825174144071a4604520849480c0a150104440b2e0f51080453400b1d07444e0d0111040a4144195d1754470b2e1e161b461e324609071d1e051e43594945074d5d13181207360d0312121b3f0c0c440e09041c431249471141150517120c230e51070b07400d03055010011360070e1417201954055544350d030e46143c0a4d0501050c141111024207104154085f440c0d121f011d7c461c07501b010756550a60104d541d1b6005640e1a1b01122446190c0b4e0b0159121b14150e4e5f5f590e641b190818077c46190c0b4e1612431e0858441c560154430d6e4a170a18533c0d0807501a0e1211051b57110a5b085442073201200d4a53240e0e18501f0b1a565508564406410154600d2b1b1a0e170778051a180803181e451e0e4144065b011b4318270e51080c533f1220440e090d1b58551b57010a5e061756506410201b4616390b094401204613600749571606596054590e641e190e460223160a12040d121e47124958070c471717120d264a14080903371806110104461c5f19121e&#x27;</span></span><br><span class="line">cipher_after =<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(cipher)/<span class="number">2</span>)):</span><br><span class="line">    temp = cipher[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">    temphex_int = <span class="built_in">ord</span>(binascii.a2b_hex(temp).decode()) - <span class="number">1</span></span><br><span class="line">    temp_re = <span class="built_in">hex</span>((temphex_int)%<span class="number">256</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    cipher_after += temp_re</span><br><span class="line"><span class="built_in">print</span>(cipher_after)</span><br></pre></td></tr></table></figure>
<p>使用相似题目的解题脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bxor</span>(<span class="params">a, b</span>):</span>     <span class="comment"># xor two byte strings of different lengths</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) &gt; <span class="built_in">len</span>(b):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a[:<span class="built_in">len</span>(b)], b)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a, b[:<span class="built_in">len</span>(a)])])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hamming_distance</span>(<span class="params">b1, b2</span>):</span></span><br><span class="line">    differing_bits = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> bxor(b1, b2):</span><br><span class="line">        differing_bits += <span class="built_in">bin</span>(byte).count(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> differing_bits</span><br><span class="line"></span><br><span class="line"><span class="comment"># text = &#x27;&#x27;</span></span><br><span class="line"><span class="comment"># with open(&quot;6.txt&quot;,&quot;r&quot;) as f:</span></span><br><span class="line"><span class="comment">#     for line in f:</span></span><br><span class="line"><span class="comment">#         text += line</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># b = base64.b64decode(text)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">break_single_key_xor</span>(<span class="params">text</span>):</span></span><br><span class="line">    key = <span class="number">0</span></span><br><span class="line">    possible_space=<span class="number">0</span></span><br><span class="line">    max_possible=<span class="number">0</span></span><br><span class="line">    letters = string.ascii_letters.encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text)):</span><br><span class="line">        maxpossible = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text)):</span><br><span class="line">            <span class="keyword">if</span>(a == b):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            c = text[a] ^ text[b]</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> letters <span class="keyword">and</span> c != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            maxpossible += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> maxpossible&gt;max_possible:</span><br><span class="line">            max_possible=maxpossible</span><br><span class="line">            possible_space=a</span><br><span class="line">    key = text[possible_space]^ <span class="number">0x20</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">chr</span>(key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">miwen_after = <span class="string">&#x27;1e114c140e1e450058114851061f40531c574337001d0d165e770c1843180c1654441c0d131403460007110c25490401081724494c0a1b4d121543541c5b064c551416110c2549070116163808404306194503510748470b0914121454432c0f16070a1e3e16040d0a1e1658101d1c13140d4753075906630c0007061a770a0a430d08091d551244130a18140412424337011548000238060443000b451d5e171a560719581a07484f6300044812132445180b0a4d16115107075d430352533f58042b1d5c480c0677120d104f190d1110070d5210035a531c5743070802030b172416404306194503510748470b09140003430a2d0e500703523f0a1c06434d0c001003094043185c1653460a2d1d151a451d314508061c1d041d42584844064c5c12171106350c0211111a3e0b0b430d08031b421148461040140416110b220d50060a063f0c02044f0f00125f060d13161f1853045443340c020d45133b094c0400040b1310100141060f4053075e430b0c111e001c7b451b064f1a00065554095f0f4c531c1a5f04630d191a00112345180b0a4d0a0058111a13140d4d5e5e580d631a180717067b45180b0a4d1511421d0757431b550053420c6d49160917523b0c07064f190d1110041a5610095a0753410631001f0c4952230d0d174f1e0a195554075543054000535f0c2a1a190d1606770419170702171d441d0d4043055a001a4217260d50070b523e111f430d080c1a57541a5600095d0516554f630f1f1a4515380a0843001f45125f0648561505585f53580d631d180d450122150911030c111d46114857060b461616110c254913070802361705100003451b5e18111d&#x27;</span></span><br><span class="line">b=binascii.a2b_hex(miwen_after)</span><br><span class="line"></span><br><span class="line">normalized_distances = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> KEYSIZE <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">40</span>):</span><br><span class="line">    <span class="comment">#我们取其中前6段计算平局汉明距离</span></span><br><span class="line">    b1 = b[: KEYSIZE]</span><br><span class="line">    b2 = b[KEYSIZE: KEYSIZE * <span class="number">2</span>]</span><br><span class="line">    b3 = b[KEYSIZE * <span class="number">2</span>: KEYSIZE * <span class="number">3</span>]</span><br><span class="line">    b4 = b[KEYSIZE * <span class="number">3</span>: KEYSIZE * <span class="number">4</span>]</span><br><span class="line">    b5 = b[KEYSIZE * <span class="number">4</span>: KEYSIZE * <span class="number">5</span>]</span><br><span class="line">    b6 = b[KEYSIZE * <span class="number">5</span>: KEYSIZE * <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    normalized_distance = <span class="built_in">float</span>(</span><br><span class="line">        hamming_distance(b1, b2) +</span><br><span class="line">        hamming_distance(b2, b3) +</span><br><span class="line">        hamming_distance(b3, b4) +</span><br><span class="line">        hamming_distance(b4, b5) +</span><br><span class="line">        hamming_distance(b5, b6)</span><br><span class="line">    ) / (KEYSIZE * <span class="number">5</span>)</span><br><span class="line">    normalized_distances.append(</span><br><span class="line">        (KEYSIZE, normalized_distance)</span><br><span class="line">    )</span><br><span class="line">normalized_distances = <span class="built_in">sorted</span>(normalized_distances,key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> KEYSIZE,_ <span class="keyword">in</span> normalized_distances[:<span class="number">5</span>]:</span><br><span class="line">    block_bytes = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(KEYSIZE)]</span><br><span class="line">    <span class="keyword">for</span> i, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(b):</span><br><span class="line">        block_bytes[i % KEYSIZE].append(byte)</span><br><span class="line">    keys = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> bbytes <span class="keyword">in</span> block_bytes:</span><br><span class="line">            keys += break_single_key_xor(bbytes)</span><br><span class="line">        key = <span class="built_in">bytearray</span>(keys * <span class="built_in">len</span>(b), <span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        plaintext = bxor(b, key)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;keysize:&quot;</span>, KEYSIZE)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;key is:&quot;</span>, keys, <span class="string">&quot;n&quot;</span>)</span><br><span class="line">        s = <span class="built_in">bytes</span>.decode(plaintext)</span><br><span class="line">        <span class="built_in">print</span>(s)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<p>结果如下<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/classic_3.png"></p>
<hr>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><hr>
<h3 id="渣男日记"><a href="#渣男日记" class="headerlink" title="渣男日记"></a>渣男日记</h3><p><code>/www.zip</code>下载源码</p>
<p>一道反序列化，主要思路是绕过wakeup<br>序列化构造如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=O:<span class="number">4</span>:<span class="string">&quot;Love&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;520&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>得到结果<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/zhananriji.png"></p>
<hr>
<h3 id="easyheehee"><a href="#easyheehee" class="headerlink" title="easyheehee"></a>easyheehee</h3><p>利用burp抓包，发现cookie,然后拖进base64二次解码，得到ffflllaaaggg.php然后加到原题目网址后面得到flag<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easyheehee1.png"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easyheehee2.png"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easyheehee3.png"></p>
<hr>
<h3 id="豪哥哥的情感日记"><a href="#豪哥哥的情感日记" class="headerlink" title="豪哥哥的情感日记"></a>豪哥哥的情感日记</h3><p>一直点就能看见flag</p>
<hr>
<h3 id="easyhtml"><a href="#easyhtml" class="headerlink" title="easyhtml"></a>easyhtml</h3><p>F12查看网页源代码就能看见flag<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/easyhtml.png"></p>
<hr>
<h3 id="我爬我爬"><a href="#我爬我爬" class="headerlink" title="我爬我爬"></a>我爬我爬</h3><p>先在网址后面加上robots.txt,提示说在ffflllaaaggg.html里，然后在网址后面加上后，得到flag<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/wopawopa1.png"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/wopawopa2.png"></p>
<hr>
<h3 id="别看我后面"><a href="#别看我后面" class="headerlink" title="别看我后面"></a>别看我后面</h3><p>php的备份名是php.bak，打开以后是php代码，读出来应该在网址后面加?Psw=5201314，然后得到flag<br><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/phpbak1.png"></p>
<p><img src="https://gitee.com/auxein/images/raw/master/scuctf2020/phpbak2.png"></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：2020SCUctf</li>
        <li>本文作者：Akk0</li>
        <li>创建时间：2020-11-29 10:11:00</li>
        <li>
            本文链接：https://auxein.xyz/2020/11/29/2020scuctf/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/02/05/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">汇编语言学习（一）</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2020/08/14/XCTF-Web_php_unserialize/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">XCTF-Web_php_unserialize</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Akk0</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.0</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A0v%E7%9C%8B%E8%9F%B9%E9%BB%84%E5%A0%A1%E7%A7%98%E6%96%B9-19%E7%BA%A7-writeup"><span class="nav-number">1.</span> <span class="nav-text">加v看蟹黄堡秘方-19级 writeup</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#RE"><span class="nav-number">1.1.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EasyF5"><span class="nav-number">1.1.1.</span> <span class="nav-text">EasyF5:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easypack"><span class="nav-number">1.1.2.</span> <span class="nav-text">easypack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pytrade"><span class="nav-number">1.1.3.</span> <span class="nav-text">pytrade</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crackme"><span class="nav-number">1.1.4.</span> <span class="nav-text">crackme</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#maze"><span class="nav-number">1.1.5.</span> <span class="nav-text">maze</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#decryptme"><span class="nav-number">1.1.6.</span> <span class="nav-text">decryptme</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pytrade-plus"><span class="nav-number">1.1.7.</span> <span class="nav-text">pytrade-plus</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MiSC"><span class="nav-number">1.2.</span> <span class="nav-text">MiSC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-number">1.2.1.</span> <span class="nav-text">签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-encode"><span class="nav-number">1.2.2.</span> <span class="nav-text">easy_encode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Excalibur"><span class="nav-number">1.2.3.</span> <span class="nav-text">Excalibur</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ylbnb"><span class="nav-number">1.2.4.</span> <span class="nav-text">ylbnb!</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CRYPTO"><span class="nav-number">1.3.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#classic-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">classic_1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#classic-2"><span class="nav-number">1.3.2.</span> <span class="nav-text">classic_2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSA-1-%E4%B8%8E-RSA-3"><span class="nav-number">1.3.3.</span> <span class="nav-text">RSA_1 与 RSA_3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#math-1"><span class="nav-number">1.3.4.</span> <span class="nav-text">math_1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSA-2"><span class="nav-number">1.3.5.</span> <span class="nav-text">RSA_2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#math-2"><span class="nav-number">1.3.6.</span> <span class="nav-text">math_2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#baby-pad"><span class="nav-number">1.3.7.</span> <span class="nav-text">baby_pad</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#classic-3"><span class="nav-number">1.3.8.</span> <span class="nav-text">classic_3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB"><span class="nav-number">1.4.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%A3%E7%94%B7%E6%97%A5%E8%AE%B0"><span class="nav-number">1.4.1.</span> <span class="nav-text">渣男日记</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyheehee"><span class="nav-number">1.4.2.</span> <span class="nav-text">easyheehee</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B1%AA%E5%93%A5%E5%93%A5%E7%9A%84%E6%83%85%E6%84%9F%E6%97%A5%E8%AE%B0"><span class="nav-number">1.4.3.</span> <span class="nav-text">豪哥哥的情感日记</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyhtml"><span class="nav-number">1.4.4.</span> <span class="nav-text">easyhtml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E7%88%AC%E6%88%91%E7%88%AC"><span class="nav-number">1.4.5.</span> <span class="nav-text">我爬我爬</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%AB%E7%9C%8B%E6%88%91%E5%90%8E%E9%9D%A2"><span class="nav-number">1.4.6.</span> <span class="nav-text">别看我后面</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/code-copy.js"></script>




<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/toc.js"></script>
    
</div>



</body>
</html>
