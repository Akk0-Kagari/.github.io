<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="无名小站">
    <meta name="author" content="Akk0">
    
    <title>
        
            Cryptopals Write-Up |
        
        Akk0&#39;s Blog
    </title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="shortcut icon" href="/images/avatar.jpg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":false},"style":{"primary_color":"#CC99FF","avatar":"/images/avatar.jpg","favicon":"/images/avatar.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"background_img":"/images/30.jpg","description":"Welcome to Akk0's Blog."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.0"};
    KEEP.language_ago = undefined;
  </script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Akk0's Blog" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                Akk0&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                友链
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">友链</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Cryptopals Write-Up</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Akk0</span>
                        
                            <span class="author-label">Lv3</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-09-23 20:59:21
    </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.7k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>17 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="Cryptopals-Write-Up"><a href="#Cryptopals-Write-Up" class="headerlink" title="Cryptopals Write-Up"></a>Cryptopals Write-Up</h1><h2 id="Set-1"><a href="#Set-1" class="headerlink" title="Set 1"></a>Set 1</h2><h3 id="0x01-Convert-hex-to-base64"><a href="#0x01-Convert-hex-to-base64" class="headerlink" title="0x01 Convert hex to base64"></a>0x01 Convert hex to base64</h3><p>The string:</p>
<blockquote>
<p>49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d</p>
</blockquote>
<p>Should produce:</p>
<blockquote>
<p>SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t</p>
</blockquote>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify</span><br><span class="line">hex_s = <span class="string">&#x27;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&#x27;</span></span><br><span class="line"></span><br><span class="line">s = unhexlify(hex_s)</span><br><span class="line"><span class="comment"># b&quot;I&#x27;m killing your brain like a poisonous mushroom&quot;</span></span><br><span class="line">b64_S = b64encode(s)</span><br><span class="line"><span class="comment"># b&#x27;SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="0x02-Fixed-XOR"><a href="#0x02-Fixed-XOR" class="headerlink" title="0x02 Fixed XOR"></a>0x02 Fixed XOR</h3><p>Write a function that takes two equal-length buffers and produces their XOR combination.</p>
<blockquote>
<p>1c0111001f010100061a024b53535009181c</p>
</blockquote>
<p>after hex decoding, and when XOR’d against:</p>
<blockquote>
<p>686974207468652062756c6c277320657965</p>
</blockquote>
<p>should produce:</p>
<blockquote>
<p>746865206b696420646f6e277420706c6179</p>
</blockquote>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"><span class="comment"># unhexlify 对象长度为偶数</span></span><br><span class="line">a = unhexlify(<span class="string">&#x27;1c0111001f010100061a024b53535009181c&#x27;</span>)</span><br><span class="line">b = unhexlify(<span class="string">&#x27;686974207468652062756c6c277320657965&#x27;</span>)</span><br><span class="line">xor_res = <span class="built_in">bytes</span>([i ^ j <span class="keyword">for</span> i,j <span class="keyword">in</span>  <span class="built_in">zip</span>(a,b)])</span><br><span class="line"><span class="built_in">print</span>(xor_res)</span><br><span class="line"><span class="comment"># b&#x27;746865206b696420646f6e277420706c6179&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="0x03-Single-byte-XOR-cipher"><a href="#0x03-Single-byte-XOR-cipher" class="headerlink" title="0x03 Single-byte XOR cipher"></a>0x03 Single-byte XOR cipher</h3><p>The hex encoded string:</p>
<blockquote>
<p>1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736</p>
</blockquote>
<p>has been XOR’d against a single character. Find the key, decrypt the message.</p>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_letter_ratio</span>(<span class="params">input_bytes</span>):</span></span><br><span class="line">    ascii_text_chars = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>)) + [<span class="number">32</span>] + <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>))</span><br><span class="line">    nb_letter = <span class="built_in">sum</span>([x <span class="keyword">in</span> ascii_text_chars <span class="keyword">for</span> x <span class="keyword">in</span> input_bytes])</span><br><span class="line">    <span class="keyword">return</span> nb_letter / <span class="built_in">len</span>(input_bytes)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_probably_text</span>(<span class="params">input_bytes</span>):</span></span><br><span class="line">    ratio = get_letter_ratio(input_bytes = input_bytes)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> ratio &gt; <span class="number">0.8</span> <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">hex_s = <span class="string">&#x27;1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736&#x27;</span></span><br><span class="line">bytes_s = unhexlify(hex_s) </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    candidate_character = <span class="built_in">bytes</span>([i])</span><br><span class="line">    stream = candidate_character * <span class="built_in">len</span>(hex_s)</span><br><span class="line">    <span class="comment"># print(stream)</span></span><br><span class="line">    xor_res = <span class="built_in">bytes</span>([a ^ b <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(bytes_s, stream)])</span><br><span class="line">    <span class="keyword">if</span> get_probably_text(input_bytes=xor_res) == <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;message: &#x27;</span>,xor_res,<span class="string">&#x27;\tkey: &#x27;</span>,candidate_character)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&quot;Cooking MC&#x27;s like a pound of bacon&quot;</span></span><br><span class="line"><span class="comment"># b&#x27;x&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="0x04-Detect-single-character-XOR"><a href="#0x04-Detect-single-character-XOR" class="headerlink" title="0x04 Detect single-character XOR"></a>0x04 Detect single-character XOR</h3><p>One of the 60-character strings in this <a class="link"   target="_blank" rel="noopener" href="https://cryptopals.com/static/challenge-data/4.txt" >file<i class="fas fa-external-link-alt"></i></a> has been encrypted by single-character XOR.</p>
<p>Find it.</p>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line">ascii_text_chars = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">97</span>, <span class="number">123</span>)) + [<span class="number">32</span>] + <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_letter_ratio</span>(<span class="params">input_bytes</span>):</span></span><br><span class="line">    nb_letter = <span class="built_in">sum</span>([x <span class="keyword">in</span> ascii_text_chars <span class="keyword">for</span> x <span class="keyword">in</span> input_bytes])</span><br><span class="line">    <span class="keyword">return</span> nb_letter / <span class="built_in">len</span>(input_bytes)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_probably_text</span>(<span class="params">input_bytes</span>):</span></span><br><span class="line">    ratio = get_letter_ratio(input_bytes = input_bytes)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> ratio &gt; <span class="number">0.8</span> <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_single_character_xor</span>(<span class="params">hex_s</span>):</span></span><br><span class="line">    bytes_s = unhexlify(hex_s)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">        candidate_character = <span class="built_in">bytes</span>([i])</span><br><span class="line">        stream = candidate_character * <span class="built_in">len</span>(hex_s)</span><br><span class="line">        <span class="comment"># print(stream)</span></span><br><span class="line">        xor_res = <span class="built_in">bytes</span>([a ^ b <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(bytes_s, stream)])</span><br><span class="line">        nb_letter = <span class="built_in">sum</span>([x <span class="keyword">in</span> ascii_text_chars <span class="keyword">for</span> x <span class="keyword">in</span> xor_res])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> get_probably_text(input_bytes=xor_res) == <span class="literal">True</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;cipher: &#x27;</span>,bytes_s,<span class="string">&#x27;\tmessage: &#x27;</span>,xor_res,<span class="string">&#x27;\tkey: &#x27;</span>,candidate_character, <span class="string">&#x27;\tnb_letter:&#x27;</span>, nb_letter)</span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">open</span>(<span class="string">&#x27;4.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> cipher:</span><br><span class="line">    crack_single_character_xor(s.strip())</span><br><span class="line"></span><br><span class="line"><span class="comment"># cipher:  b&#x27;&#123;ZB\x15A]TA\x15A]P\x15ETGAL\x15\\F\x15_@XE\\[R?&#x27;     message:  b&#x27;Now that the party is jumping\n&#x27;    key:  b&#x27;5&#x27;      nb_letter: 29</span></span><br></pre></td></tr></table></figure>

<h3 id="0x05-Implement-repeating-key-XOR"><a href="#0x05-Implement-repeating-key-XOR" class="headerlink" title="0x05 Implement repeating-key XOR"></a>0x05 Implement repeating-key XOR</h3><p>Here is the opening stanza of an important work of the English language:</p>
<blockquote>
<p>Burning ‘em, if you ain’t quick and nimble<br>I go crazy when I hear a cymbal</p>
</blockquote>
<p>Encrypt it, under the key “ICE”, using repeating-key XOR.</p>
<p>In repeating-key XOR, you’ll sequentially apply each byte of the key; the first byte of plaintext will be XOR’d against I, the next C, the next E, then I again for the 4th byte, and so on.</p>
<p>It should come out to:</p>
<blockquote>
<p>0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272<br>a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f</p>
</blockquote>
<h3 id="0x06-Break-repeating-key-XOR"><a href="#0x06-Break-repeating-key-XOR" class="headerlink" title="0x06 Break repeating-key XOR"></a>0x06 Break repeating-key XOR</h3><p>There’s a <a class="link"   target="_blank" rel="noopener" href="https://cryptopals.com/static/challenge-data/6.txt" >file<i class="fas fa-external-link-alt"></i></a> here. It’s been base64’d after being encrypted with repeating-key XOR.</p>
<p>Decrypt it.</p>
<p>Here’s how:</p>
<ol>
<li><p>Let KEYSIZE be the guessed length of the key; try values from 2 to (say) 40.</p>
</li>
<li><p>Write a function to compute the edit distance/Hamming distance between two strings. The Hamming distance is just the number of differing bits. The distance between:</p>
<blockquote>
<p>this is a test</p>
</blockquote>
</li>
</ol>
<p>and </p>
<blockquote>
<p>wokka wokka!!!</p>
</blockquote>
<p>is 37. Make sure your code agrees before you proceed.</p>
<ol start="3">
<li><p>For each KEYSIZE, take the first KEYSIZE worth of bytes, and the second KEYSIZE worth of bytes, and find the edit distance between them. Normalize this result by dividing by KEYSIZE.</p>
</li>
<li><p>The KEYSIZE with the smallest normalized edit distance is probably the key. You could proceed perhaps with the smallest 2-3 KEYSIZE values. Or take 4 KEYSIZE blocks instead of 2 and average the distances.</p>
</li>
<li><p>Now that you probably know the KEYSIZE: break the ciphertext into blocks of KEYSIZE length.</p>
</li>
<li><p>Now transpose the blocks: make a block that is the first byte of every block, and a block that is the second byte of every block, and so on.</p>
</li>
<li><p>Solve each block as if it was single-character XOR. You already have code to do this.</p>
</li>
<li><p>For each block, the single-byte XOR key that produces the best looking histogram is the repeating-key XOR key byte for that block. Put them together and you have the key.</p>
</li>
</ol>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bxor</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([i ^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a,b)])</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hamming_distance</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(<span class="built_in">bin</span>(byte).count(<span class="string">&#x27;1&#x27;</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> bxor(a,b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;6.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext= b64decode(f.read())</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">score_vigenere_key_size</span>(<span class="params">candidate_key_size, ciphertext</span>):</span></span><br><span class="line">    slice_size = <span class="number">2</span> * candidate_key_size</span><br><span class="line">    </span><br><span class="line">    nb_mesurements = <span class="built_in">len</span>(ciphertext) // slice_size - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    score = <span class="number">0</span> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nb_mesurements):</span><br><span class="line">        slice1 = <span class="built_in">slice</span>(i * slice_size , i * slice_size + candidate_key_size)</span><br><span class="line">        slice2 = <span class="built_in">slice</span>(i  * slice_size + candidate_key_size , i * slice_size + <span class="number">2</span> * candidate_key_size)</span><br><span class="line">        </span><br><span class="line">        score += hamming_distance(ciphertext[slice1], ciphertext[slice2])</span><br><span class="line">        </span><br><span class="line">    score /= candidate_key_size</span><br><span class="line">    score /= nb_mesurements</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> score</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_vigenere_key_length</span>(<span class="params">ciphertext, min_length = <span class="number">2</span>,max_length = <span class="number">30</span></span>):</span></span><br><span class="line">    key = <span class="keyword">lambda</span> x : score_vigenere_key_size(x, ciphertext)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">min</span>(<span class="built_in">range</span>(min_length,max_length),key = key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack_single_byte_xor</span>(<span class="params">ciphertext</span>):</span></span><br><span class="line">    best = &#123;<span class="string">&quot;nb_letters&quot;</span>:<span class="number">0</span>&#125;</span><br><span class="line">    ascii_text_chars = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">97</span>, <span class="number">122</span>)) + [<span class="number">32</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">8</span>):</span><br><span class="line">        candidate_key = i.to_bytes(<span class="number">1</span>,byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        candidate_message = bxor(ciphertext, candidate_key * <span class="built_in">len</span>(ciphertext))</span><br><span class="line">        nb_letters = <span class="built_in">sum</span>([x <span class="keyword">in</span> ascii_text_chars <span class="keyword">for</span> x <span class="keyword">in</span> candidate_message])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> best == <span class="literal">None</span> <span class="keyword">or</span> nb_letters &gt; best[<span class="string">&quot;nb_letters&quot;</span>]:</span><br><span class="line">            best = &#123;<span class="string">&quot;message&quot;</span> : candidate_message, <span class="string">&quot;nb_letters&quot;</span> : nb_letters, <span class="string">&quot;key&quot;</span>: candidate_key&#125;</span><br><span class="line">    <span class="keyword">return</span> best</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack_repeating_key_xor</span>(<span class="params">ciphertext</span>):</span></span><br><span class="line">    keysize = find_vigenere_key_length(ciphertext)</span><br><span class="line">    </span><br><span class="line">    key = <span class="built_in">bytes</span>()</span><br><span class="line">    </span><br><span class="line">    message_parts = <span class="built_in">list</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(keysize):</span><br><span class="line">        part = attack_single_byte_xor(<span class="built_in">bytes</span>(ciphertext[i::keysize]))</span><br><span class="line">        key += part[<span class="string">&quot;key&quot;</span>]    </span><br><span class="line">        message_parts.append(part[<span class="string">&quot;message&quot;</span>])</span><br><span class="line">    </span><br><span class="line">    message = <span class="built_in">bytes</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">max</span>(<span class="built_in">map</span>(<span class="built_in">len</span>,message_parts))):</span><br><span class="line">        message += <span class="built_in">bytes</span>(part[i] <span class="keyword">for</span> part <span class="keyword">in</span> message_parts <span class="keyword">if</span> <span class="built_in">len</span>(part) &gt;= i + <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&#x27;message&#x27;</span>:message, <span class="string">&#x27;key&#x27;</span>:key&#125;</span><br><span class="line"></span><br><span class="line">result = attack_repeating_key_xor(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;key: &quot;</span>, result[<span class="string">&quot;key&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;message&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(result[<span class="string">&quot;message&quot;</span>].decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># key:  b&#x27;Terminator X: Bring the noise&#x27;</span></span><br><span class="line"><span class="comment"># message</span></span><br><span class="line"><span class="comment"># I&#x27;m back and I&#x27;m ringin&#x27; the bell </span></span><br><span class="line"><span class="comment"># A rockin&#x27; on the mike while the fly girls yell </span></span><br><span class="line"><span class="comment"># In ecstasy in the back of me </span></span><br><span class="line"><span class="comment"># Well that&#x27;s my DJ Deshay cuttin&#x27; all them Z&#x27;s </span></span><br><span class="line"><span class="comment"># Hittin&#x27; hard and the girlies goin&#x27; crazy </span></span><br><span class="line"><span class="comment"># Vanilla&#x27;s on the mike, man I&#x27;m not lazy. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I&#x27;m lettin&#x27; my drug kick in </span></span><br><span class="line"><span class="comment"># It controls my mouth and I begin </span></span><br><span class="line"><span class="comment"># To just let it flow, let my concepts go </span></span><br><span class="line"><span class="comment"># My posse&#x27;s to the side yellin&#x27;, Go Vanilla Go! </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Smooth &#x27;cause that&#x27;s the way I will be </span></span><br><span class="line"><span class="comment"># And if you don&#x27;t give a damn, then </span></span><br><span class="line"><span class="comment"># Why you starin&#x27; at me </span></span><br><span class="line"><span class="comment"># So get off &#x27;cause I control the stage </span></span><br><span class="line"><span class="comment"># There&#x27;s no dissin&#x27; allowed </span></span><br><span class="line"><span class="comment"># I&#x27;m in my own phase </span></span><br><span class="line"><span class="comment"># The girlies sa y they love me and that is ok </span></span><br><span class="line"><span class="comment"># And I can dance better than any kid n&#x27; play </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Stage 2 -- Yea the one ya&#x27; wanna listen to </span></span><br><span class="line"><span class="comment"># It&#x27;s off my head so let the beat play through </span></span><br><span class="line"><span class="comment"># So I can funk it up and make it sound good </span></span><br><span class="line"><span class="comment"># 1-2-3 Yo -- Knock on some wood </span></span><br><span class="line"><span class="comment"># For good luck, I like my rhymes atrocious </span></span><br><span class="line"><span class="comment"># Supercalafragilisticexpialidocious </span></span><br><span class="line"><span class="comment"># I&#x27;m an effect and that you can bet </span></span><br><span class="line"><span class="comment"># I can take a fly girl and make her wet. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I&#x27;m like Samson -- Samson to Delilah </span></span><br><span class="line"><span class="comment"># There&#x27;s no denyin&#x27;, You can try to hang </span></span><br><span class="line"><span class="comment"># But you&#x27;ll keep tryin&#x27; to get my style </span></span><br><span class="line"><span class="comment"># Over and over, practice makes perfect </span></span><br><span class="line"><span class="comment"># But not if you&#x27;re a loafer. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You&#x27;ll get nowhere, no place, no time, no girls </span></span><br><span class="line"><span class="comment"># Soon -- Oh my God, homebody, you probably eat </span></span><br><span class="line"><span class="comment"># Spaghetti with a spoon! Come on and say it! </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># VIP. Vanilla Ice yep, yep, I&#x27;m comin&#x27; hard like a rhino </span></span><br><span class="line"><span class="comment"># Intoxicating so you stagger like a wino </span></span><br><span class="line"><span class="comment"># So punks stop trying and girl stop cryin&#x27; </span></span><br><span class="line"><span class="comment"># Vanilla Ice is sellin&#x27; and you people are buyin&#x27; </span></span><br><span class="line"><span class="comment"># &#x27;Cause why the freaks are jockin&#x27; like Crazy Glue </span></span><br><span class="line"><span class="comment"># Movin&#x27; and groovin&#x27; trying to sing along </span></span><br><span class="line"><span class="comment"># All through the ghetto groovin&#x27; this here song </span></span><br><span class="line"><span class="comment"># Now you&#x27;re amazed by the VIP posse. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Steppin&#x27; so hard like a German Nazi </span></span><br><span class="line"><span class="comment"># Startled by the bases hittin&#x27; ground </span></span><br><span class="line"><span class="comment"># There&#x27;s no trippin&#x27; on mine, I&#x27;m just gettin&#x27; down </span></span><br><span class="line"><span class="comment"># Sparkamatic, I&#x27;m hangin&#x27; tight like a fanatic </span></span><br><span class="line"><span class="comment"># You trapped me once and I thought that </span></span><br><span class="line"><span class="comment"># You might have it </span></span><br><span class="line"><span class="comment"># So step down and lend me your ear </span></span><br><span class="line"><span class="comment"># &#x27;89 in my time! You, &#x27;90 is my year. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You&#x27;re weakenin&#x27; fast, YO! and I can tell it </span></span><br><span class="line"><span class="comment"># Your body&#x27;s gettin&#x27; hot, so, so I can smell it </span></span><br><span class="line"><span class="comment"># So don&#x27;t be mad and don&#x27;t be sad </span></span><br><span class="line"><span class="comment"># &#x27;Cause the lyrics belong to ICE, You can call me Dad </span></span><br><span class="line"><span class="comment"># You&#x27;re pitchin&#x27; a fit, so step back and endure </span></span><br><span class="line"><span class="comment"># Let the witch doctor, Ice, do the dance to cure </span></span><br><span class="line"><span class="comment"># So come up close and don&#x27;t be square </span></span><br><span class="line"><span class="comment"># You wanna battle me -- Anytime, anywhere </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You thought that I was weak, Boy, you&#x27;re dead wrong </span></span><br><span class="line"><span class="comment"># So come on, everybody and sing this song </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Say -- Play that funky music Say, go white boy, go white boy go </span></span><br><span class="line"><span class="comment"># play that funky music Go white boy, go white boy, go </span></span><br><span class="line"><span class="comment"># Lay down and boogie and play that funky music till you die. </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Play that funky music Come on, Come on, let me hear </span></span><br><span class="line"><span class="comment"># Play that funky music white boy you say it, say it </span></span><br><span class="line"><span class="comment"># Play that funky music A little louder now </span></span><br><span class="line"><span class="comment"># Play that funky music, white boy Come on, Come on, Come on </span></span><br><span class="line"><span class="comment"># Play that funky music</span></span><br></pre></td></tr></table></figure>


<h3 id="0x07-AES-in-ECB-mode"><a href="#0x07-AES-in-ECB-mode" class="headerlink" title="0x07 AES in ECB mode"></a>0x07 AES in ECB mode</h3><p>The Base64-encoded content in this <a class="link"   target="_blank" rel="noopener" href="https://cryptopals.com/static/challenge-data/7.txt" >file<i class="fas fa-external-link-alt"></i></a> has been encrypted via AES-128 in ECB mode under the key</p>
<blockquote>
<p>“YELLOW SUBMARINE”.</p>
</blockquote>
<p>(case-sensitive, without the quotes; exactly 16 characters; I like “YELLOW SUBMARINE” because it’s exactly 16 bytes long, and now you do too).</p>
<p>Decrypt it. You know the key, after all.</p>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;7.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = b64decode(f.read())</span><br><span class="line">key = <span class="string">b&#x27;YELLOW SUBMARINE&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_aes_128_ecb</span>(<span class="params">ciphertext, key</span>):</span></span><br><span class="line">    backend = default_backend()</span><br><span class="line">    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend= backend)</span><br><span class="line">    decryptor = cipher.decryptor()</span><br><span class="line">    decrypted_data = decryptor.update(ciphertext) + decryptor.finalize()</span><br><span class="line">    </span><br><span class="line">    message = decrypted_data</span><br><span class="line">    <span class="keyword">return</span> message</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(</span><br><span class="line">    decrypt_aes_128_ecb(</span><br><span class="line">        ciphertext = data,</span><br><span class="line">        key = key</span><br><span class="line">        ).decode()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># I&#x27;m back and I&#x27;m ringin&#x27; the bell </span></span><br><span class="line"><span class="comment"># A rockin&#x27; on the mike while the fly girls yell</span></span><br><span class="line"><span class="comment"># In ecstasy in the back of me</span></span><br><span class="line"><span class="comment"># Well that&#x27;s my DJ Deshay cuttin&#x27; all them Z&#x27;s</span></span><br><span class="line"><span class="comment"># Hittin&#x27; hard and the girlies goin&#x27; crazy</span></span><br><span class="line"><span class="comment"># Vanilla&#x27;s on the mike, man I&#x27;m not lazy.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I&#x27;m lettin&#x27; my drug kick in</span></span><br><span class="line"><span class="comment"># It controls my mouth and I begin</span></span><br><span class="line"><span class="comment"># To just let it flow, let my concepts go</span></span><br><span class="line"><span class="comment"># My posse&#x27;s to the side yellin&#x27;, Go Vanilla Go!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Smooth &#x27;cause that&#x27;s the way I will be</span></span><br><span class="line"><span class="comment"># And if you don&#x27;t give a damn, then</span></span><br><span class="line"><span class="comment"># Why you starin&#x27; at me</span></span><br><span class="line"><span class="comment"># So get off &#x27;cause I control the stage</span></span><br><span class="line"><span class="comment"># There&#x27;s no dissin&#x27; allowed</span></span><br><span class="line"><span class="comment"># I&#x27;m in my own phase</span></span><br><span class="line"><span class="comment"># The girlies sa y they love me and that is ok</span></span><br><span class="line"><span class="comment"># And I can dance better than any kid n&#x27; play</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Stage 2 -- Yea the one ya&#x27; wanna listen to</span></span><br><span class="line"><span class="comment"># It&#x27;s off my head so let the beat play through</span></span><br><span class="line"><span class="comment"># So I can funk it up and make it sound good</span></span><br><span class="line"><span class="comment"># 1-2-3 Yo -- Knock on some wood</span></span><br><span class="line"><span class="comment"># For good luck, I like my rhymes atrocious</span></span><br><span class="line"><span class="comment"># Supercalafragilisticexpialidocious</span></span><br><span class="line"><span class="comment"># I&#x27;m an effect and that you can bet</span></span><br><span class="line"><span class="comment"># I can take a fly girl and make her wet.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I&#x27;m like Samson -- Samson to Delilah</span></span><br><span class="line"><span class="comment"># There&#x27;s no denyin&#x27;, You can try to hang</span></span><br><span class="line"><span class="comment"># But you&#x27;ll keep tryin&#x27; to get my style</span></span><br><span class="line"><span class="comment"># Over and over, practice makes perfect</span></span><br><span class="line"><span class="comment"># But not if you&#x27;re a loafer.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You&#x27;ll get nowhere, no place, no time, no girls</span></span><br><span class="line"><span class="comment"># Soon -- Oh my God, homebody, you probably eat</span></span><br><span class="line"><span class="comment"># Spaghetti with a spoon! Come on and say it!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># VIP. Vanilla Ice yep, yep, I&#x27;m comin&#x27; hard like a rhino</span></span><br><span class="line"><span class="comment"># Intoxicating so you stagger like a wino</span></span><br><span class="line"><span class="comment"># So punks stop trying and girl stop cryin&#x27;</span></span><br><span class="line"><span class="comment"># Vanilla Ice is sellin&#x27; and you people are buyin&#x27;</span></span><br><span class="line"><span class="comment"># &#x27;Cause why the freaks are jockin&#x27; like Crazy Glue</span></span><br><span class="line"><span class="comment"># Movin&#x27; and groovin&#x27; trying to sing along</span></span><br><span class="line"><span class="comment"># All through the ghetto groovin&#x27; this here song</span></span><br><span class="line"><span class="comment"># Now you&#x27;re amazed by the VIP posse.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Steppin&#x27; so hard like a German Nazi</span></span><br><span class="line"><span class="comment"># Startled by the bases hittin&#x27; ground</span></span><br><span class="line"><span class="comment"># There&#x27;s no trippin&#x27; on mine, I&#x27;m just gettin&#x27; down</span></span><br><span class="line"><span class="comment"># Sparkamatic, I&#x27;m hangin&#x27; tight like a fanatic</span></span><br><span class="line"><span class="comment"># You trapped me once and I thought that</span></span><br><span class="line"><span class="comment"># You might have it</span></span><br><span class="line"><span class="comment"># So step down and lend me your ear</span></span><br><span class="line"><span class="comment"># &#x27;89 in my time! You, &#x27;90 is my year.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You&#x27;re weakenin&#x27; fast, YO! and I can tell it</span></span><br><span class="line"><span class="comment"># Your body&#x27;s gettin&#x27; hot, so, so I can smell it</span></span><br><span class="line"><span class="comment"># So don&#x27;t be mad and don&#x27;t be sad</span></span><br><span class="line"><span class="comment"># &#x27;Cause the lyrics belong to ICE, You can call me Dad</span></span><br><span class="line"><span class="comment"># You&#x27;re pitchin&#x27; a fit, so step back and endure</span></span><br><span class="line"><span class="comment"># Let the witch doctor, Ice, do the dance to cure</span></span><br><span class="line"><span class="comment"># So come up close and don&#x27;t be square</span></span><br><span class="line"><span class="comment"># You wanna battle me -- Anytime, anywhere</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You thought that I was weak, Boy, you&#x27;re dead wrong</span></span><br><span class="line"><span class="comment"># So come on, everybody and sing this song</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Say -- Play that funky music Say, go white boy, go white boy go</span></span><br><span class="line"><span class="comment"># play that funky music Go white boy, go white boy, go</span></span><br><span class="line"><span class="comment"># Lay down and boogie and play that funky music till you die.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Play that funky music Come on, Come on, let me hear</span></span><br><span class="line"><span class="comment"># Play that funky music white boy you say it, say it</span></span><br><span class="line"><span class="comment"># Play that funky music A little louder now</span></span><br><span class="line"><span class="comment"># Play that funky music, white boy Come on, Come on, Come on</span></span><br><span class="line"><span class="comment"># Play that funky music</span></span><br></pre></td></tr></table></figure>

<h3 id="0x08-Detect-AES-in-ECB-mode"><a href="#0x08-Detect-AES-in-ECB-mode" class="headerlink" title="0x08 Detect AES in ECB mode"></a>0x08 Detect AES in ECB mode</h3><p>In this <a class="link"   target="_blank" rel="noopener" href="https://cryptopals.com/static/challenge-data/8.txt" >file<i class="fas fa-external-link-alt"></i></a> are a bunch of hex-encoded ciphertexts.</p>
<p>One of them has been encrypted with ECB.</p>
<p>Detect it.</p>
<p>Remember that the problem with ECB is that it is stateless and deterministic; the same 16 byte plaintext block will always produce the same 16 byte ciphertext.</p>
<p>solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;8.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertexts = [unhexlify(line.strip()) <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">has_repeated_blocks</span>(<span class="params">ciphertext, blocksize = <span class="number">16</span></span>):</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ciphertext) % blocksize != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;ciphertext length is not a multiple of block size&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        num_blocks = <span class="built_in">len</span>(ciphertext) // blocksize</span><br><span class="line">        </span><br><span class="line">    blocks = [ciphertext[i*blocksize:(i+<span class="number">1</span>)*blocksize] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_blocks)]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(blocks)) != num_blocks:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">hits = [ciphertext <span class="keyword">for</span> ciphertext <span class="keyword">in</span> ciphertexts <span class="keyword">if</span> has_repeated_blocks(ciphertext)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hits)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [b&#x27;\xd8\x80a\x97@\xa8\xa1\x9bx@\xa8\xa3\x1c\x81\n=\x08d\x9a\xf7\r\xc0oO\xd5\xd2\xd6\x9ctL\xd2\x83\xe2\xdd\x05/kd\x1d\xbf\x9d\x11\xb04\x85B\xbbW\x08d\x9a\xf7\r\xc0oO\xd5\xd2\xd6\x9ctL\xd2\x83\x94u\xc9\xdf\xdb\xc1\xd4e\x97\x94\x9d\x9c~\x82\xbfZ\x08d\x9a\xf7\r\xc0oO\xd5\xd2\xd6\x9ctL\xd2\x83\x97\xa9&gt;\xab\x8dj\xec\xd5fH\x91Tx\x9ak\x03\x08d\x9a\xf7\r\xc0oO\xd5\xd2\xd6\x9ctL\xd2\x83\xd4\x03\x18\x0c\x98\xc8\xf6\xdb\x1f*?\x9c@@\xde\xb0\xabQ\xb2\x993\xf2\xc1#\xc5\x83\x86\xb0o\xba\x18j&#x27;]</span></span><br></pre></td></tr></table></figure>
        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：Cryptopals Write-Up</li>
        <li>本文作者：Akk0</li>
        <li>创建时间：2021-09-23 20:59:21</li>
        <li>
            本文链接：https://auxein.xyz/2021/09/23/Cryptopals-Write-Up/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/08/13/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%E2%80%94%E2%80%94%E9%93%BE%E6%8E%A5%E3%80%81%E8%A3%85%E8%BD%BD%E4%B8%8E%E5%BA%93-%E7%AC%94%E8%AE%B0/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">程序员的自我修养——链接、装载与库 笔记</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Akk0</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.0</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Cryptopals-Write-Up"><span class="nav-number">1.</span> <span class="nav-text">Cryptopals Write-Up</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Set-1"><span class="nav-number">1.1.</span> <span class="nav-text">Set 1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x01-Convert-hex-to-base64"><span class="nav-number">1.1.1.</span> <span class="nav-text">0x01 Convert hex to base64</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x02-Fixed-XOR"><span class="nav-number">1.1.2.</span> <span class="nav-text">0x02 Fixed XOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x03-Single-byte-XOR-cipher"><span class="nav-number">1.1.3.</span> <span class="nav-text">0x03 Single-byte XOR cipher</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x04-Detect-single-character-XOR"><span class="nav-number">1.1.4.</span> <span class="nav-text">0x04 Detect single-character XOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x05-Implement-repeating-key-XOR"><span class="nav-number">1.1.5.</span> <span class="nav-text">0x05 Implement repeating-key XOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x06-Break-repeating-key-XOR"><span class="nav-number">1.1.6.</span> <span class="nav-text">0x06 Break repeating-key XOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x07-AES-in-ECB-mode"><span class="nav-number">1.1.7.</span> <span class="nav-text">0x07 AES in ECB mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x08-Detect-AES-in-ECB-mode"><span class="nav-number">1.1.8.</span> <span class="nav-text">0x08 Detect AES in ECB mode</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/code-copy.js"></script>




<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.0/source/js/toc.js"></script>
    
</div>



</body>
</html>
